# 配置界面 (ConfigInterface)

## 1. 模块概述

提供树状结构的参数配置界面，支持系统连接控制和参数调整。

## 2. 界面结构

```
ConfigInterface (TreeWidget)
├── System Status
│   └── Connection (SwitchButton)
├── Receiver
│   └── FFT
│       ├── Length (ComboBox)
│       ├── Decimation Factor (ComboBox)
│       └── Centre Frequency (LineEdit)
├── DAC/ADC
│   ├── DAC00
│   └── DAC02
└── Algorithm
    └── Detection Parameters
```

## 3. 技术实现

### 3.1 树状控件
```python
self.config_tree = TreeWidget()
self.config_tree.setColumnCount(2)  # 参数名 | 控件
```

### 3.2 动态控件添加
```python
def add_fft_parameter(parent_item, param_name, value, options):
    # 创建QWidget容器
    param_widget = QWidget()
    param_layout = QHBoxLayout()
    
    # 添加：当前值标签 + 输入控件 + Set按钮
    value_label = QLabel(str(value))
    input_widget = ComboBox() or LineEdit()
    set_button = PushButton("Set")
    
    # 设置为树项的控件
    self.config_tree.setItemWidget(param_item, 1, param_widget)
```

## 4. 连接控制

### 4.1 开关信号
```python
connection_request = pyqtSignal(bool)  # 自定义信号

def on_switch_toggled(self, checked):
    self.connection_switch.setEnabled(False)  # 防重复点击
    self.connection_request.emit(checked)  # 发出请求
```

### 4.2 状态同步
```python
def on_connection_state_changed(self, is_connected):
    self.connection_switch.blockSignals(True)  # 阻止循环
    self.connection_switch.setChecked(is_connected)
    self.connection_switch.blockSignals(False)
    self.connection_switch.setEnabled(True)
```

## 5. 参数持久化

```python
def save_parameters(self):
    with open("parameters.json", "w") as f:
        json.dump(self.parameters, f, indent=2)
```

## 6. 与其他模块的接口

### 6.1 输出信号
- **connection_request(bool)** → DroneDetectionSystem

### 6.2 输入信号
- **State.connection_changed(bool)** → 更新开关状态